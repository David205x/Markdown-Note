# L17 进程同步与信号量
### 引入：信号量的缺陷
- 信号量解决了资源合理分配的问题
- 并发：若干并发的进程共同修改信号量，会发生什么？

### 进入临界区Peterson算法
```C
//进程P0
flag[0] = true;   //独有的量
turn = 1;         //共享的量，下次轮到0了
while(flag[1] && turn == 1);
临界区代码...;
flag[0] = false;
```
```C
//进程P1
flag[1] = true;   //独有的量
turn = 0;         //共享的量，下次轮到1了
while(flag[0] && turn == 0);
临界区代码...;
flag[1] = false;
```
#####

- 互斥进入: 如果两个进程都进入，则`flag[0]==flag[1]==true`， `turn`既是0又是1，产生矛盾
- 有空让进: 如果进程`P1`不在临界区，则P0能进入，因为：
  - `P1`离开时令`flag[1]=false`
  - 或者`P1`企图再入时令`turn=0`
- 有限等待: `P0`要求进入，`flag[0]=true`；后面的P1不可能一直进入，因为P1执行一次就会让`turn=0`来谦让

!!! tip 考点
    什么是信号量，信号量的定义
    临界区代码的保护原则