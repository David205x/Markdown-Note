## 绪论

- 成绩占比
  - `70%` 期末考核
  - `30%` 平时成绩
    - 随堂测验
    - 签到



## 第一章：引言

- 计算机网络定义
  - 多个独立的计算机通过网络连接
  - 通过一套技术在不同系统间交流
- 分类
  - 按规模分类
    - 个人网
    - 局域网
      - 总线网
      - 环型网
    - 广域网
  - 按传输技术分类
    - 广播式
    - 点对点式

### 网络软件

- 协议层次结构
  - 层次栈/分级栈[^ 每一层目的想上一层提供特定的服务，而把如何实现的服务细节对上一层加以屏蔽]
  - 协议[^ 通信双方就如何进行通信的一种约定]
  - 接口[^ 下层向上层提供那些原语操作和服务]
  - 网络体系结构[^ 层和协议的集合]

- 信息的传递需经历层层打包和解包

- 面向连接&无连接的服务
  - 面向连接的服务[^ Eg: 管道专线连接 ]
  - 无连接服务[^ Eg: 邮政式中转分发]



### 参考模型

- 七层OSI参考模型
  1. 物理层：关注一条通信信道上传输原始比特
  
  2. 链路层：将一个原始的传输设施转变成一条没有漏检传输错误的线路
  
  3. 网络层：控制子网的运行
  
  4. 运输层：接受来自上一层的数据，必要时把这些数据分割成较小的单元，

     ​				然把这些数据单元传递给网络层，并且确保这些数据单元正确到达另一端
  
     ​				真正的端到端的层
  
  5. 会话层：允许不同机器上的用户建立会话
  
  6. 表示层：关注所传递信息的语法和语义
  
  7. 应用层：包含了用户通常需要的各种各样的协议
  
- TCP/IP参考模型

  1. 链路层(略)：主机与传输线路之间的一个接口，描述链路需完成什么才能满足无连接的互联网络层的需求

  2. 互联网层：将整个网络体系结构贯穿在一起的关键层

     > IP[^ 定义了官方的数据包格式和协议]，ICMP[^ 因特网控制报文协议]

  3. 传输层：允许源主机和目标主机上的对等实体进行对话

     > TCP[^ 可靠的，面向连接的协议]，UDP[^ 不可靠的，面向无连接的协议]

  4. 应用层：包含所有高层协议

     > TELNET，FTP，SMTP，HTTP

- OSI和TCP/IP参考模型的比较
  - service interface protocol
  - OSI：影响力强概念明晰；被政治局势影响产生
  - TCP/IP：成功且运转良好的协议，并成为标准；实际指导产生的协议，分层模糊易混淆

- Hybird Model[^ 现今在用的模型]

### 网络实例

- Internet
  - 大量网络的集合
  - 使用特定公共协议并提供特定公共服务
  - 前身APRANET：分组交换
- Ethernet
  - 总线式(相对于广播式的传播方式)
  - 小范围
- Wireless Networks

- 网络有影响力的组织
  - ISO[^ 国际标准化组织]，ITU[^ ]，IEEE[^ ]，ETF[^ ]，W3C[^ ]

### 1.9章总结



## 第二章：物理层[^ 比特]

> 物理层<u>**比特**</u> - 链路层<u>帧</u>

### 2.6.5交换

- 电路交换[^ 基于实际端到端物理路径的信息交换]

  > 保证服务，可能浪费资源

- 包交换/分组交换[^ 路由器使用储存-转发技术，由于无固定路径，到达的秩序可能出现混乱]

  > 不保证服务，不会浪费资源

  - 规定数据包的大小：确保不发生霸占传输线路的问题
  - 没为传输数据预留带宽：排队延迟




## 第三章：数据链路层[^ 帧]

> 物理层<u>比特</u> - 链路层**<u>帧</u>** - 网络层<u>包</u>

### 3.1 设计问题

- 主要功能
  - 给网络层提供服务接口
  - 处理传输错误
  - 调节数据流，适应不同速设备不被淹没
- (数据)帧的构成：帧头，有效载荷，帧尾

#### 3.1.1 提供给网络层的服务

- 无确认的无连接：源机器向目标机器发送独立的帧，目标机器并不对这些帧进行确认

  - 特点

    - 不需建立逻辑连接，不用释放逻辑连接
    - 不试图检测丢帧或试图恢复丢失帧

  - 用于错误率低的场合，靠上层恢复；实时通信，延迟比受损更严重

    > Ethernet

- 有确认的无连接：不使用逻辑连接，但每一帧需独立确认

  - 用于不可靠的信道

    > 802.11

- 有确认的有连接：建立逻辑连接，编号每一帧并确认收到

  - 特点
    - 最复杂服务：建立/维护/释放连接，初始化/释放变量和计数器
    - 所有帧只被接收一次，且按照正确顺序接收

#### 3.1.2 成帧[^ 为方便纠错拆分比特流为帧并附上校验]

- 字节计数法[^ 利用头部中的一个字段来表示该帧中字符数]

  - 问题
    - 因一个传输错误而混乱，造成此起后续所有数据无法被正确识别
    - 且接收方无法得知距离开始处多少字节

- 字节填充的标志字节法[^ 用标志字节作为帧的起始和结束分界符]

  - 解决：出错后的重新同步问题：搜索两个标志字节以获取当前帧结尾和下一帧起始

  - 问题
    - 标志字节`FLAG` `ESC`出现在数据中时影响帧的分界
      - 字节填充技术：前面再添加转义字节`ESC`
    - 只能使用8比特的字节

- 比特填充的标志比特法[^ 在比特级完成帧的划分，帧可包含任意大小单元组成的二进制比特数。开始结束由特殊比特模式决定]

  - 用填充比特的方法避免标志比特在内容中出现(标志比特连6个1，则内容每连续5个1补1个0)
  - 解决：只能使用8比特的字节为单元

  > USB

- 物理层编码违禁法(略)

- 差错控制[^ 修复收到的错误]

  > - 要求错误被接收方发现

#### 3.1.3 流量控制[^ 处理不同速设备信息间传输堵塞]

- 基于反馈的流量控制
- 基于速率的流量控制

### 3.2 错误检测和纠错

### 3.3 基本数据链路层协议

#### 3.3.1 乌托邦式的单工协议[^ 不考虑任何出错的情况，仅单向传输]

- 收发双方**总处于准备就绪**状态，数据**处理时间不计**，**可用缓存无穷大**，链路层通信信道**永不损坏帧或丢帧**

```C++
void sender1(void) {
    frame s;
    packet buffer;
    while(true) {
        网络层接收数据储存至buffer;
        转buffer中信息为frame;
        把frame发送给物理层;
    }
}
void recerver1(void) {
    frame r;
    event_type event;
    while(true) {
        等事件触发发生;
        接收并将硬件缓冲区的bit转为frame;
        解析frame转化并传递给网络层;
    }
}
```

#### 3.3.2 无措信道上的单工停-等式协议[^ 考虑接收方可能被高速发送方的帧淹没情况]

- 建立强大接收器
- 接收方传递数据包至网络层后发送反馈信息(哑帧)[^ 仅在一个方向上传输数据]

#### 3.3.3 有错信道上的单工停-等式协议[^ 考虑常规 出错帧 损坏帧 丢失帧情况]

- 能区分到达的帧是首次发来的新帧或是被重传的老帧
- 带有重传的肯定确认`PAR`[^ 仅在一个方向上传输数据]
- 双方链路层处于等待状态时用变量记录下个要发送的帧序号/下个期待帧序号
- 发出方发出一帧后启动/重置计时器，在足够长的计时器到时后确认帧仍未接收到/损坏则重新发送
- 接收方检查接收帧的序号，若非重复数据包则传给网络层并返回确认帧，重复则返回对应确认帧

#### 3.3.4 滑动窗口协议[^ 考虑全双工数据传输]

- 稍待确认：暂时延缓确认以便将确认信息搭载在下一个出境数据帧的技术

- 滑动窗口[^ 任何时刻发送方和接收方总维持一组序号，仅发送/接收窗口序号内的帧]
  - 1位滑动窗口协议[^ 等-停式]
    - 

#### 3.4.3选择重传协议

## 第四章：介质访问控制子层[^ 数据链路层的子层，处于底部]

- 介质访问控制子层`MAC`：控制多路访问信道下一个使用者的协议

### 4.1 信道分配问题

#### 4.1.1 静态信道分配

- 频分多路复用`FDM`：带宽被等分，用户使用专用频段
- 缺点：无法应对发送方数量多且经常变化、**突发性流量**，资源浪费低效

#### 4.1.2 动态信道分配假设

- 假设基础：流量独立，担心到，冲突可观察，时间连续或分槽，载波侦听或不停

### 4.2 多路访问协议

#### 4.2.1 ALOHA

- 纯ALOHA[^ 时间是连续的]
  - 用户有数据需要发送时就传输
  - 中央计算机广播发送站发来的帧，发送站可侦听帧是否发生冲突
  - 但凡发生两个帧在相同时间占用信道，冲突发生且二帧损坏，发送方随机等待再重发送
  - 竞争系统：多用户共享同一个信道的方法会导致冲突的系统
- 分槽ALOHA[^ 时间分成离散槽]
  - 将时间分成离散的间隔，每个时间槽对应于一帧，用户仅能在下一个时槽的开始时刻传输
  - 测试帧所在同一个时间槽没有其他流量的概率是$$S=Ge^{-G}$$ G:每包时的尝试次数，S:每帧吞吐量
  - ...
  - 信道利用率最大1/e

#### 4.2.2 载波侦听多路访问协议

- 载波侦听协议：站监听是否存在载波(传输)并采取相应的动作
- 坚持和非坚持CSMA
  - 流程
    - 发送数据前**监听信道**使用情况
    - 信道空闲则发送数据
    - 信道忙则等待直至信道空闲
    - 冲突则随即等待时长
  - 问题
    - 两站等待前一站发完后同时开始传输
    - 信号传播延迟影响...

#### 4.2.3 无冲突协议

- 位图协议
- 令牌传递
- 二进制倒计数

#### 4.2.5 无线局域网协议

- CSMA
  - 问题：未考虑无线传输特性，冲突发生在接收方
    - 隐藏终端问题：竞争者离得太远导致无法检测到潜在的竞争者，发送者检测不到视野外与目标通信的
    - 暴露终端问题：非竞争者将另目标不同的终端检测为竞争者而产生传输延迟
    - 原因：有线情形同一时刻仅能有一个传输在进行；无线情形允许多个传输同时发生
- 冲突避免多路访问`MACA`
  - 基本思想：发送方刺激接收方输出一个短帧，以便其附近的站能检测到该次传输
  - 流程
    - 发送方给接收方发送RTS帧，包括数据帧长度
    - 接收方接收到RTS帧用CTS作应答，包括RTS中的数据帧长度
    - RTS和使非目标接收方保持沉默足够长保证CTS被无冲接受，此后可自由发送
    - CTS和使非目标接收方保持沉默直到传输结束再进行传输，通过其中数据帧的长度得知传输进度 

### 4.3 以太网[^ 实际系统应用]

#### 4.3.1 经典以太网物理层

- 多台计算机通过长电缆上的接口电缆相连
- 速率10Mbps
- 计算机使用以太网协议通信
- CSMA/CD调度传输

#### 4.3.2 经典以太网MAC子层协议

|       8       |    6     |   6    |  2   | 0-1500 | 0-46 |   4    |
| :-----------: | :------: | :----: | :--: | :----: | :--: | :----: |
| 前导码+定界符 | 目标地址 | 源地址 | 类型 |  数据  | 填充 | 校验和 |

- 前导码：同步时钟，SOF定界符告知即将开始帧
- 目标地址：第一位为0表示普通地址；为1表示组地址，允许对应的多站监听；全1表示广播
- 填充：保证最小帧长以获得可靠检测，避免：
  - 一个短帧没到达电缆远端的发送方，该帧的传输已经结束，电缆的远端，该帧与零一阵发生冲突
  - 导致发送方误认为冲突消息被正确接收

#### 4.3.3 以太网系性能		

- 帧长越长，效率越高

#### 4.3.4 交换式以太网



#### 4.3.5-7 快速以太网-万兆以太网

### 4.4 无线局域网

#### 4.4.1 802.11体系结构和协议栈

#### 4.4.4、

### 4.8 数据链路层交换

#### 4.8.1 网桥的使用

#### 4.8.2 学习网桥

- 后向学习法

#### 4.8.4 



## 第五章：网络层

### 5.1 网络层的设计问题

#### 5.1.1 储存转发数据包交换

#### 5.1.2 提供给传输层的服务

#### 5.1.3 无连接服务的实现

#### 5.1.4 面向连接服务的实现
